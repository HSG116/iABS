
const fs = require('fs');
const path = require('path');

const inputFile = path.join(__dirname, 'constants.ts');
const outputFile = path.join(__dirname, 'constants_updated.ts');

console.log('Reading from:', inputFile);
const content = fs.readFileSync(inputFile, 'utf8');
console.log('Read ' + content.length + ' bytes');

// 1. Define the new questions text (raw) for reference or direct insertion
// We will build the new objects programmatically or structurally.

const newRamadanQuestions = [
    // Group 1
    { q: 'ما هو العنصر الكيميائي الذي يرمز له بالرمز (Au)؟', o: ['الفضة', 'النحاس', 'الذهب', 'الألمنيوم'], c: 2 },
    { q: 'أين يقع تمثال الحرية؟', o: ['واشنطن', 'نيويورك', 'لوس أنجلوس', 'شيكاغو'], c: 1 },
    { q: 'كم عدد لاعبي فريق كرة القدم داخل الملعب؟', o: ['9 لاعبين', '10 لاعبين', '11 لاعباً', '12 لاعباً'], c: 2 },
    { q: 'ما هي الدولة التي تعتبر أكبر منتج للبن في العالم؟', o: ['كولومبيا', 'إثيوبيا', 'البرازيل', 'فيتنام'], c: 2 },
    { q: 'من هو الرسام الذي رسم لوحة "الموناليزا"؟', o: ['مايكل أنجلو', 'ليوناردو دافنشي', 'بيكاسو', 'فان جوخ'], c: 1 },
    { q: 'ما هو الغاز الذي يستخدم عادة في إطفاء الحرائق؟', o: ['الأكسجين', 'الهيدروجين', 'ثاني أكسيد الكربون', 'النيتروجين'], c: 2 },
    { q: 'ما هي عاصمة إيطاليا؟', o: ['ميلانو', 'روما', 'البندقية', 'نابولي'], c: 1 },
    { q: 'في أي قارة تقع دولة فلسطين؟', o: ['أفريقيا', 'أوروبا', 'آسيا', 'أستراليا'], c: 2 },
    { q: 'ما هو الحيوان الذي يُعرف بسفينة الصحراء؟', o: ['الحصان', 'الجمل', 'الفيل', 'الذئب'], c: 1 },
    { q: 'كم عدد ألوان قوس قزح؟', o: ['5 ألوان', '6 ألوان', '7 ألوان', '8 ألوان'], c: 2 },
    { q: 'من هو مخترع الطائرة؟', o: ['الأخوان رايت', 'جراهام بيل', 'توماس أديسون', 'إسحاق نيوتن'], c: 0 },
    { q: 'ما هي العملة المستخدمة في الكويت؟', o: ['الريال', 'الدرهم', 'الدينار', 'الليرة'], c: 2 },
    { q: 'ما هو أكبر طائر في العالم حالياً؟', o: ['النسر', 'النعامة', 'البطريق', 'الطاووس'], c: 1 },
    { q: 'ما هو الاسم القديم لمدينة القسطنطينية؟', o: ['إسطنبول', 'أنقرة', 'بيزنطة', 'أثينا'], c: 2 },
    { q: 'كم عدد أحرف اللغة العربية؟', o: ['26 حرفاً', '27 حرفاً', '28 حرفاً', '29 حرفاً'], c: 2 },
    { q: 'ما هو المعدن الذي يعتبر أفضل موصل للكهرباء؟', o: ['الذهب', 'النحاس', 'الفضة', 'الحديد'], c: 2 },
    { q: 'من هو القائد المسلم الذي فتح الأندلس؟', o: ['خالد بن الوليد', 'طارق بن زياد', 'صلاح الدين الأيوبي', 'عقبة بن نافع'], c: 1 },
    { q: 'ما هي الدولة التي عاصمتها "موسكو"؟', o: ['أوكرانيا', 'روسيا', 'بولندا', 'بيلاروسيا'], c: 1 },
    { q: 'ما هو الجزء الملون في عين الإنسان؟', o: ['الشبكية', 'القرنية', 'القزحية', 'البؤبؤ'], c: 2 },
    { q: 'كم سنة استمرت الحرب العالمية الأولى؟', o: ['3 سنوات', '4 سنوات', '5 سنوات', '6 سنوات'], c: 1 },
    { q: 'ما هو أسرع كوكب يدور حول الشمس؟', o: ['الأرض', 'المشتري', 'عطارد', 'نبتون'], c: 2 },
    { q: 'ما هي الدولة التي تشتهر بأكلة "البيتزا"؟', o: ['فرنسا', 'أمريكا', 'إيطاليا', 'تركيا'], c: 2 },
    { q: 'ما هو الاسم الكيميائي لملح الطعام؟', o: ['كلوريد الصوديوم', 'نترات البوتاسيوم', 'كبريتات الحديد', 'أكسيد المغنيسيوم'], c: 0 },
    { q: 'من هو النبي الذي ألقاه إخوته في البئر؟', o: ['موسى عليه السلام', 'يوسف عليه السلام', 'عيسى عليه السلام', 'يونس عليه السلام'], c: 1 },
    { q: 'ما هي أكبر بحيرة عذبة في أفريقيا؟', o: ['بحيرة ناصر', 'بحيرة تنجانيقا', 'بحيرة فيكتوريا', 'بحيرة طبريا'], c: 2 },

    // Group 2
    { q: 'ما هو الشيء الذي يقرصك ولا تراه؟', o: ['البرد', 'الجوع', 'الحرارة', 'الظلام'], c: 1 },
    { q: 'ما هي عاصمة الهند؟', o: ['مومباي', 'نيودلهي', 'كلكتا', 'حيدر أباد'], c: 1 },
    { q: 'من هو مؤلف علم الجبر؟', o: ['ابن سينا', 'الخوارزمي', 'ابن الهيثم', 'الرازي'], c: 1 },
    { q: 'كم عدد عضلات جسم الإنسان تقريباً؟', o: ['206 عضلة', '400 عضلة', 'أكثر من 600 عضلة', '100 عضلة'], c: 2 },
    { q: 'ما هو الكوكب الذي يمتلك حلقات واضحة حوله؟', o: ['المريخ', 'زحل', 'الأرض', 'عطارد'], c: 1 },
    { q: 'في أي دولة تقع الأهرامات الثلاثة الشهيرة؟', o: ['السودان', 'المكسيك', 'مصر', 'بيرو'], c: 2 },
    { q: 'ما هو الحيوان الذي يستخرج منه المسك؟', o: ['الأسد', 'الغزال', 'الفيل', 'الحوت'], c: 1 },
    { q: 'كم يبلغ عدد ألوان علم دولة الإمارات العربية المتحدة؟', o: ['2', '3', '4', '5'], c: 2 },
    { q: 'من هو الصحابي الذي كانت تستحي منه الملائكة؟', o: ['عمر بن الخطاب', 'عثمان بن عفان', 'علي بن أبي طالب', 'أبو بكر الصديق'], c: 1 },
    { q: 'ما هو اسم أنثى الأسد؟', o: ['لبوة', 'مها', 'ناقة', 'فرس'], c: 0 },
    { q: 'ما هي الدولة التي تسمى "بلاد الرافدين"؟', o: ['سوريا', 'العراق', 'الأردن', 'لبنان'], c: 1 },
    { q: 'ما هو الغاز الذي تتنفسه النباتات في الليل؟', o: ['الأكسجين', 'ثاني أكسيد الكربون', 'النيتروجين', 'الهيليوم'], c: 0 },
    { q: 'أين أقيمت أول بطولة لكأس العالم لكرة القدم؟', o: ['البرازيل', 'إيطاليا', 'الأوروغواي', 'ألمانيا'], c: 2 },
    { q: 'كم عدد السجدات في القرآن الكريم؟', o: ['10 سجدات', '12 سجدة', '15 سجدة', '20 سجدة'], c: 2 },
    { q: 'ما هو العنصر الأساسي في صناعة الزجاج؟', o: ['الحديد', 'الرمل (السيليكا)', 'الخشب', 'البلاستيك'], c: 1 },
    { q: 'ما هي عاصمة أستراليا؟', o: ['سيدني', 'ملبورن', 'كانبرا', 'بيرث'], c: 2 },
    { q: 'ما هو الحيوان الذي يعتبر الأذكى بعد الإنسان (رئيسيات)؟', o: ['الدلفين', 'الشمبانزي', 'الفيل', 'الكلب'], c: 1 },
    { q: 'في أي مدينة يقع المسجد الأقصى؟', o: ['مكة', 'المدينة', 'القدس', 'الخليل'], c: 2 },
    { q: 'ما هي العملة الرسمية في المملكة المتحدة (بريطانيا)؟', o: ['اليورو', 'الدولار', 'الجنيه الإسترليني', 'الفرنك'], c: 2 },
    { q: 'ما هو المعدن الذي يكون سائلاً في درجة حرارة الغرفة؟', o: ['الحديد', 'الزئبق', 'النحاس', 'الذهب'], c: 1 },
    { q: 'من هو مكتشف قانون الجاذبية الأرضية؟', o: ['ألبرت أينشتاين', 'إسحاق نيوتن', 'جاليليو', 'داروين'], c: 1 },
    { q: 'ما هو الطائر الذي يضع أكبر بيضة؟', o: ['الدجاجة', 'النعامة', 'البطريق', 'العقاب'], c: 1 },
    { q: 'ما هي أكبر قارة في العالم من حيث المساحة؟', o: ['أفريقيا', 'أمريكا الشمالية', 'آسيا', 'أوروبا'], c: 2 },
    { q: 'ما هو اللقب الذي أطلق على زوجات النبي محمد ﷺ؟', o: ['الصحابيات', 'التابعيات', 'أمهات المؤمنين', 'المبشرات'], c: 2 },
    { q: 'كم عدد أرجل العنكبوت؟', o: ['4 أرجل', '6 أرجل', '8 أرجل', '10 أرجل'], c: 2 },

    // Group 3
    { q: 'ما هو الشيء الذي كلما زاد نقص؟', o: ['المال', 'العمر', 'الماء', 'العلم'], c: 1 },
    { q: 'ما هي الدولة الوحيدة التي استخدمت القنبلة الذرية في الحرب؟', o: ['روسيا', 'ألمانيا', 'الولايات المتحدة', 'اليابان'], c: 2 },
    { q: 'ما هي عاصمة لبنان؟', o: ['دمشق', 'عمان', 'بيروت', 'بغداد'], c: 2 },
    { q: 'من هو "سيد الشهداء" في غزوة أحد؟', o: ['مصعب بن عمير', 'حمزة بن عبد المطلب', 'جعفر الطيار', 'عبد الله بن مسعود'], c: 1 },
    { q: 'كم عدد الأسنان اللبنية عند الطفل؟', o: ['20 سناً', '28 سناً', '32 سناً', '10 أسنان'], c: 0 },
    { q: 'ما هو البحر الذي لا يوجد به أسماك بسبب ملوحته الشديدة؟', o: ['البحر الأحمر', 'البحر الأبيض المتوسط', 'البحر الميت', 'البحر الأسود'], c: 2 },
    { q: 'من هو مخترع الديناميت الذي ندم وأسس جائزة للسلام؟', o: ['ألفريد نوبل', 'أينشتاين', 'ماري كوري', 'تسلا'], c: 0 },
    { q: 'ما هي عاصمة البرازيل؟', o: ['ريو دي جانيرو', 'ساو باولو', 'برازيليا', 'بوينس آيرس'], c: 2 },
    { q: 'ما هو اسم صوت الذئب؟', o: ['نباح', 'عواء', 'زئير', 'صهيل'], c: 1 },
    { q: 'كم عدد الدقائق في الساعة الواحدة؟', o: ['50 دقيقة', '60 دقيقة', '100 دقيقة', '24 دقيقة'], c: 1 },
    { q: 'أين تقع مدينة "البتراء" الأثرية؟', o: ['سوريا', 'العراق', 'الأردن', 'مصر'], c: 2 },
    { q: 'ما هو الغاز الذي نخرجه عند الزفير؟', o: ['الأكسجين', 'ثاني أكسيد الكربون', 'الهيدروجين', 'النيتروجين'], c: 1 },
    { q: 'من هي المرأة الوحيدة التي ذكر اسمها صراحة في القرآن الكريم؟', o: ['حواء', 'آسيا', 'مريم بنت عمران', 'خديجة'], c: 2 },
    { q: 'ما هي أكبر دولة من حيث عدد السكان (حالياً تتنافس مع الصين)؟', o: ['الولايات المتحدة', 'روسيا', 'الهند', 'إندونيسيا'], c: 2 },
    { q: 'ما هو الشيء الذي يكتب ولا يقرأ؟', o: ['الكتاب', 'القلم', 'النظارة', 'الهاتف'], c: 1 },
    { q: 'من هو مكتشف الدورة الدموية الصغرى؟', o: ['ابن سينا', 'ابن النفيس', 'ابن الهيثم', 'الرازي'], c: 1 },
    { q: 'ما هي العاصمة الإدارية لتركيا؟', o: ['إسطنبول', 'أنطاليا', 'أنقرة', 'إزمير'], c: 2 },
    { q: 'ما هو الحيوان الذي لا يشرب الماء طيلة حياته (يستخلصه من بذور)؟', o: ['الفأر', 'الجرذ الكنغري', 'الضب', 'الجمل'], c: 1 },
    { q: 'ما هو المعدن الذي ينجذب للمغناطيس؟', o: ['الألمنيوم', 'الذهب', 'الحديد', 'النحاس'], c: 2 },
    { q: 'كم عدد لاعبين فريق كرة السلة داخل الملعب؟', o: ['5 لاعبين', '6 لاعبين', '7 لاعبين', '11 لاعباً'], c: 0 },
    { q: 'ما هي الدولة التي تشبه الخريطة الحذاء (الجزمة)؟', o: ['إسبانيا', 'البرتغال', 'إيطاليا', 'اليونان'], c: 2 },
    { q: 'من هو أول إنسان وطأت قدماه سطح القمر؟', o: ['يوري جاجارين', 'نيل أرمسترونج', 'مايكل كولينز', 'باز ألدرين'], c: 1 },
    { q: 'ما هو أطول نهر في العالم؟', o: ['نهر النيل', 'نهر الأمازون', 'نهر المسيسيبي', 'نهر اليانغتسي'], c: 0 },
    { q: 'ما هو الحيوان الذي يسمى "ملك الغابة"؟', o: ['النمر', 'الفيل', 'الأسد', 'الدب'], c: 2 },
    { q: 'كم عدد الوان علم المملكة العربية السعودية؟', o: ['لون واحد', 'لونان (أخضر وأبيض)', '3 ألوان', '4 ألوان'], c: 1 },

    // Group 4
    { q: 'ما هو الشيء الذي له عين ولا يرى؟', o: ['الإبرة', 'المسمار', 'القلم', 'الباب'], c: 0 },
    { q: 'ما هي عاصمة فرنسا؟', o: ['لندن', 'برلين', 'باريس', 'مدريد'], c: 2 },
    { q: 'ما هو العضو الذي يضخ الدم في الجسم؟', o: ['الكبد', 'الرئة', 'القلب', 'المعدة'], c: 2 },
    { q: 'من هو النبي الذي ابتلعه الحوت؟', o: ['يونس عليه السلام', 'موسى عليه السلام', 'نوح عليه السلام', 'أيوب عليه السلام'], c: 0 },
    { q: 'ما هو أسرع حيوان بحري؟', o: ['القرش', 'الحوت الأزرق', 'سمكة الزعنفة الشراعية (السمكة الشراعية)', 'الدولفين'], c: 2 },
    { q: 'ما هو الرقم الذي إذا ضربته في أي رقم آخر يكون الناتج صفراً؟', o: ['واحد', 'عشرة', 'صفر', 'خمسة'], c: 2 },
    { q: 'ما هي الدولة التي تشتهر بوجود "تاج محل"؟', o: ['باكستان', 'الهند', 'بنغلاديش', 'إيران'], c: 1 },
    { q: 'ما هو الحيوان الذي يستطيع تغيير لونه؟', o: ['الحرباء', 'الثعبان', 'الضفدع', 'السلحفاة'], c: 0 },
    { q: 'كم عدد سور القرآن الكريم؟', o: ['110', '112', '114', '120'], c: 2 },
    { q: 'ما هي عاصمة ألمانيا؟', o: ['ميونخ', 'هامبورغ', 'برلين', 'فرانكفورت'], c: 2 },
    { q: 'ما هو الشيء الذي ليس له بداية ولا نهاية؟', o: ['الخط المستقيم', 'الدائرة', 'المثلث', 'المربع'], c: 1 },
    { q: 'من هو الصحابي الذي نام في فراش النبي ﷺ ليلة الهجرة؟', o: ['أبو بكر الصديق', 'عمر بن الخطاب', 'علي بن أبي طالب', 'عثمان بن عفان'], c: 2 },
    { q: 'ما هو الذهب الأسود؟', o: ['الفحم', 'الحديد', 'البترول (النفط)', 'القهوة'], c: 2 },
    { q: 'كم عدد أرجل النملة؟', o: ['4 أرجل', '6 أرجل', '8 أرجل', '10 أرجل'], c: 1 },
    { q: 'ما هي أكبر جزيرة في العالم؟', o: ['مدغشقر', 'جرينلاند', 'بريطانيا', 'اليابان'], c: 1 },
    { q: 'من هو الشاعر الملقب بـ "متنبي"؟', o: ['أحمد بن الحسين', 'أحمد شوقي', 'نزار قباني', 'جرير'], c: 0 },
    { q: 'ما هي الدولة التي عاصمتها "طوكيو"؟', o: ['الصين', 'كوريا', 'اليابان', 'فيتنام'], c: 2 },
    { q: 'ما هو الشيء الذي تحمله ويحملك؟', o: ['الحذاء', 'الحقيبة', 'السيارة', 'القبعة'], c: 0 },
    { q: 'ما هو الفيتامين الذي نستمده من أشعة الشمس؟', o: ['فيتامين C', 'فيتامين A', 'فيتامين D', 'فيتامين B'], c: 2 },
    { q: 'ما هي عاصمة المغرب؟', o: ['الدار البيضاء', 'فاس', 'الرباط', 'مراكش'], c: 2 },
    { q: 'من هو أول الخلفاء الراشدين؟', o: ['عمر بن الخطاب', 'علي بن أبي طالب', 'أبو بكر الصديق', 'عثمان بن عفان'], c: 2 },
    { q: 'ما هي اللغة الأكثر تحدثاً في العالم (كلغة أم)؟', o: ['الإنجليزية', 'العربية', 'الصينية (الماندرين)', 'الإسبانية'], c: 2 },
    { q: 'ما هو الطائر الذي يعتبر رمزاً للحكمة؟', o: ['الصقر', 'البومة', 'الغراب', 'الهدهد'], c: 1 },
    { q: 'ما هو الشيء الذي يوجد في وسط باريس؟', o: ['برج إيفل', 'حرف الراء (ر)', 'نهر السين', 'متحف اللوفر'], c: 1 },
    { q: 'ما هو الكوكب الذي نعيش عليه؟', o: ['المريخ', 'الزهرة', 'الأرض', 'زحل'], c: 2 },
];

// Helper to format a question object
function formatQ(id, qObj) {
    return `  { id: ${id}, category: 'ramadan', text: '${qObj.q.replace(/'/g, "\\'")}', options: [${qObj.o.map(x => `'${x.replace(/'/g, "\\'")}'`).join(', ')}], correctIndex: ${qObj.c} },`;
}

// 2. Process the file content

// Regex to find Question objects
const qRegex = /\{\s*id:\s*(\d+),\s*category:\s*'(\w+)',\s*text:/g;
// We need to rebuild the file line by line for safety

const lines = content.split('\n');
let newLines = [];
let inQuestions = false;
let ramadanCount = 0;
let lastRamadanSeen = false;

// Category offsets
const categoryStarts = {
    'movies': 201,
    'cars': 251,
    'islamic': 301,
    'football': 351,
    'animals': 401,
    'gaming': 451,
    'anime': 501,
    'history': 551,
    'science': 601,
    'saudi': 651,
    'technology': 701,
    'music': 751,
    'geography': 801,
    'food': 851,
    'people': 901
};

// We also need to normalize current IDs to 0-based index within category to apply offset
// But we don't know the index easily without tracking.
// So we track current ID in category.
let currentCategory = '';
let currentCatIdCounter = 0;
let lastCat = '';

// Helper to update ID in a line
function updateLineId(line, newId) {
    return line.replace(/id:\s*\d+/, `id: ${newId}`);
}

// Track processed categories to avoid re-processing duplicate blocks (garbage)
const processedCategories = new Set();

for (let i = 0; i < lines.length; i++) {
    const line = lines[i];

    // Check if we are inside QUESTIONS_DB
    if (line.includes('export const QUESTIONS_DB')) {
        inQuestions = true;
        newLines.push(line);
        continue;
    }
    if (inQuestions && line.trim().startsWith('];')) {
        inQuestions = false;
        newLines.push(line);
        continue;
    }

    if (inQuestions) {
        // Parse category from line
        const catMatch = line.match(/category:\s*'(\w+)'/);
        if (catMatch) {
            const cat = catMatch[1];

            if (cat !== lastCat) {
                if (lastCat) {
                    processedCategories.add(lastCat);
                }

                if (processedCategories.has(cat)) {
                    // This is a duplicate block (garbage), skip this line
                    console.log(`Skipping duplicate/garbage block for category: ${cat}`);
                    continue;
                }

                currentCatIdCounter = 0;
                lastCat = cat;
            } else {
                if (processedCategories.has(cat)) {
                    // Continuing inside a garbage block
                    continue;
                }
            }

            currentCatIdCounter++;

            if (cat === 'ramadan') {
                // Keep existing ramadan questions (1-80) as is.
                newLines.push(line);

                // If we hit the last existing ramadan question (id 80), insert the new ones.
                const idMatch = line.match(/id:\s*(\d+)/);
                if (idMatch && parseInt(idMatch[1]) === 80) {
                    // Insert new questions
                    newLines.push('');
                    newLines.push('  // New Ramadan Questions (81-180)');
                    newRamadanQuestions.forEach((q, idx) => {
                        newLines.push(formatQ(81 + idx, q));
                    });
                    newLines.push('');
                }
            } else {
                // Apply offsets
                if (categoryStarts[cat]) {
                    const newId = categoryStarts[cat] + (currentCatIdCounter - 1);
                    newLines.push(updateLineId(line, newId));
                } else {
                    newLines.push(line);
                }
            }
        } else {
            // Comments or empty lines
            // If we are currently in a garbage block (skipped category), we should probably skip comments too?
            // But we don't strictly know if the comment belongs to the garbage block or next valid block.
            // However, typically comments precede the block.
            // If I keep `// إسلاميات`, it will be fine.
            // If I keep `// عالم السيارات` which precedes garbage cars, it's redundant but harmless.
            newLines.push(line);
        }
    } else {
        newLines.push(line);
    }
}

console.log('Writing to:', outputFile);
fs.writeFileSync(outputFile, newLines.join('\n'));
console.log('Done.');

